Organizes the dataset to minimize sampling error
while still allowing efficient batching.